outputs:
  default:
    type: elasticsearch
    hosts: ["http://3.109.139.197:9200"]
    ssl.verification_mode: none


agent:
  monitoring:
    enabled: true
    logs: true
    metrics: true
  logging:
    level: debug
    to_stderr: true
    to_files: true
    files:
      path: /var/log/elastic-agent

inputs:
  - type: filestream
    id: spring-logfile
    paths:
      - /app/logs/*
    parsers:
      - ndjson:
          target: ""
          overwrite_keys: true
    processors:
      - add_fields:
          target: ""
          fields:
            component: "spring-app"
            environment: "prod"
            data_stream.dataset: "spring.logs"
            data_stream.namespace: "production"
            data_stream.type: "logs"

  - type: system/metrics
    data_stream:
      namespace: production
    streams:
      - metricsets: ["cpu", "memory", "network", "process", "filesystem", "diskio"]
        period: 10s
    processors:
      - add_fields:
          fields:
            component: "spring-app"
            environment: "prod"


  - type: http
    id: app-health
    schedule: "@every 15s"
    urls: ["http://localhost:8080/actuator/health"]
    check.response:
      status: 200
      json:
        - path: status
          equals: "UP"
    data_stream:
      type: synthetics
      dataset: http.up
    processors:
      - add_fields:
          fields:
            component: "spring-app"
            environment: "prod"

  - type: apm
    server_url: "http://3.109.139.197:8200"
    data_stream:
      namespace: production

  - type: container
